var l=Object.defineProperty;var d=(s,t,e)=>t in s?l(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var a=(s,t,e)=>(d(s,typeof t!="symbol"?t+"":t,e),e);class _{constructor(){a(this,"_storage");a(this,"_handlerMap");a(this,"_options");a(this,"_default");a(this,"loaded");this._storage=chrome.storage.local,this._handlerMap=new Map,this._options={},this._default={double_click_translate_enabled:!0,show_tooltip_enabled:!0,textarea_translate_enabled:!1,currency_convert_enabled:!0,conversion_notification_disabled:!1,conversion_notification_last:0,conversion_notification_type:1},this.loaded=!1;const t=this;chrome.storage.onChanged.addListener((e,n)=>{var r;if(n==="local"){for(const o in e)t._options[o]=e[o].newValue;for(const o in e)(r=this._handlerMap.get(o))==null||r.forEach(i=>i())}})}load(){return new Promise(t=>{this._storage.get(null,e=>{this._options=e,this.loaded=!0,this._storage.onChanged.addListener(n=>{Object.entries(n).forEach(([r,o])=>{this._options[r]=o.newValue})}),t(e)})})}set(t,e){const n={};(typeof t=="string"||typeof t=="number"&&typeof e<"u")&&(n[t]=e,this._options[t]=e,this._storage.set(n))}get(t){return this.loaded&&t in this._options?this._options[t]:this._default[t]}has(t){return typeof this._options[t]<"u"}remove(t){delete this._options[t],this._storage.remove([t],()=>{const e=chrome.runtime.lastError;e&&console.warn("Caught",e)})}addOptionChangedListener(t,e){const n=this._handlerMap.get(t)??[];n.push(e),this._handlerMap.set(t,n)}}class h extends _{isTranslateEnabled(t){return t==="input"||t==="textarea"?this.get("textarea_translate_enabled"):!0}isDoubleClickTranslateEnabled(t){return this.isTranslateEnabled(t)?this.get("double_click_translate_enabled"):!1}isShowTooltipEnabled(){return this.get("show_tooltip_enabled")}isCurrencyConvertEnabled(){return this.get("currency_convert_enabled")}}const u=new h;export{_ as S,u as s};
